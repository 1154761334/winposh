# winposh

由于疫情隔离在家且网络环境较差，需要和舍友一起在局域网下share一台电脑上的EDA软件，因此才摸索出了如下方法，以下操作有风险，且均来源于网上已有教程或者开源项目或脚本。

我们首先要确定自己的系统是家庭版还是专业版，windows家庭版可以远程连接专业版的电脑，而无法被别的电脑连接，但可以尝试通过github上的开源项目了解能否获得权限（操作有风险）。

但是即使是专业版系统，也被限制了仅允许同时一个账户远程连接，就算修改了组策略配置中的限制连接用户数目也没法改变。

网络上一般给出的方法是修改termsrv.dll系统文件（高危操作，记得做好备份以免系统无法正常运行），这个.dll文件是已经被编译过的16进制文件，可以通过vscode添加HEX解码扩展功能来读取。

但termsrv.dll系统文件中需要被的修改代码依每台电脑具体的系统版本不同而有所不同，每次进行系统安全更新后，上述更改便会失效，因此自动的配置脚本是更为方便的，github上有如下开源脚本代码：
winposh/termsrv_rdp_patch.ps1 at main · maxbakhub/winposh (github.com)
https://github.com/maxbakhub/winposh/blob/main/termsrv_rdp_patch.ps1
可以通过power shell运行，每次系统更新后执行一遍脚本即可。

但是即使脚本运行在管理员模式下，也可能没有替换termsrv.dll系统文件的权限，并且重启后由于Windows的系统文件缺失检查功能，很可能导致修改失效。因此我们需要进入系统的安全模式下才能成功运行脚本，重启后远程桌面服务即可正常启动。
